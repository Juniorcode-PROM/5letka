{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}
<h1>Kanban Board</h1>
<hr/>

<div class="row">
    <div class="col-md-4">
        <h3>To Do</h3>
        {% for task in tasks.todo %}
        <div class="task">
            <h5>{{ task.title }}</h5>
            <p>{{ task.description }}</p>
        </div>
        {% empty %}
        <p>No tasks to do.</p>
        {% endfor %}
    </div>

    <div class="col-md-4">
        <h3>In Progress</h3>
        {% for task in tasks.in_progress %}
        <div class="task">
            <h5>{{ task.title }}</h5>
            <p>{{ task.description }}</p>
        </div>
        {% empty %}
        <p>No tasks in progress.</p>
        {% endfor %}
    </div>

    <div class="col-md-4">
        <h3>Done</h3>
        {% for task in tasks.done %}
        <div class="task">
            <h5>{{ task.title }}</h5>
            <p>{{ task.description }}</p>
        </div>
        {% empty %}
        <p>No completed tasks.</p>
        {% endfor %}
    </div>
</div>

<hr/>

{% if request.user.is_authenticated %}
<h4>Add New Task</h4>
<form method="POST" action="{% url 'add_task' %}">
    {% csrf_token %}
    {{ form | crispy }}
    <button type="submit" class="btn btn-outline-secondary">Add Task</button>
</form>
{% else %}
<p class="text-muted">Please log in to add tasks.</p>
{% endif %}
{% endblock %}
